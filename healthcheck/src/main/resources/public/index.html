<html>
<head>
<style type="text/css">
.url { color: blue; }
.status { color: gray}
li{ height: 30px}
</style>
</head>
<body>
<h2>Welcome to the NextGen Service Health Check Page (Heroku Only)  </h2> 

<ul>
	<li><span id="config" class="status">UNKNOWN</span>  	|  <span class="url">https://nextgen-config.herokuapp.com</span> | Configuration Service </li>
	<li><span id="eureka" class="status">UNKNOWN</span>  	|  <span class="url">https://nextgen-registry.herokuapp.com</span> | Service Discovery (Eureka) Service  </li>
	<li><span id="profile" class="status">UNKNOWN</span> 	|  <span class="url">https://nextgen-profile.herokuapp.com</span> | Profile Service   </li>
	<li><span id="reservation" class="status">UNKNOWN</span>|  <span class="url">https://nextgen-reservation.herokuapp.com</span> | Reservation Service   </li>
	<li><span id="addon" class="status">UNKNOWN</span>  	|  <span class="url">https://nextgen-addon-svcs.herokuapp.com</span> | Addon/Misc Services   </li>
	<li><span id="monitor" class="status">UNKNOWN</span>  	|  <span class="url">https://nextgen-monitor.herokuapp.com</span> | Hystrix Dashboard Service   </li>
	<li><span id="gateway" class="status">UNKNOWN</span>  	|  <span class="url">https://nextgen-gateway.herokuapp.com</span> | Service Gateway (Zuul)   </li>
</ul>

<p> 
	<input type="button" id="activateheroku" value="Activate Services">
	<!-- <input type="button" id="editEndpoints" value="Edit Endpoints">  -->  
</p>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript">

	$(document).ready(function(){
		/*$("#editEndpoints").click(function() {
			if ($("#editEndpoints").val() === 'SAVE') {
				$("#editEndpoints").val("Edit Endpoints");
				$("#epconfig").attr('readonly', 'true');
				$("#epeureka").attr('readonly', 'true');
				$("#epprofile").attr('readonly', 'true');
				$("#epreservation").attr('readonly', 'true');
				$("#epaddone").attr('readonly', 'true');
				$("#epmonitor").attr('readonly', 'true');
				$("#epconfig").attr('readonly', 'true');
				$("#epgateway").attr('readonly', 'true');
				
				$("#epconfig").css('border-style', 'none');
				$("#epeureka").css('border-style', 'none');
				$("#epprofile").css('border-style', 'none');
				$("#epreservation").css('border-style', 'none');
				$("#epaddone").css('border-style', 'none');
				$("#epmonitor").css('border-style', 'none');
				$("#epconfig").css('border-style', 'none');
				$("#epgateway").css('border-style', 'none');
			} else {
				$("#editEndpoints").val("SAVE");
				$("#epconfig").removeAttr('readonly');
				$("#epeureka").removeAttr('readonly');
				$("#epprofile").removeAttr('readonly');
				$("#epreservation").removeAttr('readonly');
				$("#epaddone").removeAttr('readonly');
				$("#epmonitor").removeAttr('readonly');
				$("#epconfig").removeAttr('readonly');
				$("#epgateway").removeAttr('readonly');
				
				$("#epconfig").css('border-style', 'inset');
				$("#epeureka").css('border-style', 'inset');
				$("#epprofile").css('border-style', 'inset');
				$("#epreservation").css('border-style', 'inset');
				$("#epaddone").css('border-style', 'inset');
				$("#epmonitor").css('border-style', 'inset');
				$("#epconfig").css('border-style', 'inset');
				$("#epgateway").css('border-style', 'inset');
			}
		});*/
		
		$("#activateheroku").click(function() {
			var yn = confirm("Do you want to start ALL HEROKU Services ?")
			if (yn === true) {
				health("/config/ping?host=https://nextgen-config.herokuapp.com", "config");
		        health("/eureka/ping?host=https://nextgen-registry.herokuapp.com", "eureka");
		        health("/profile/ping?host=https://nextgen-profile.herokuapp.com", "profile");
		        health("/reservation/ping?host=https://nextgen-reservation.herokuapp.com", "reservation");
		        health("/addonsvc/ping?host=https://nextgen-addon-svcs.herokuapp.com", "addon");
		        health("/monitor/ping?host=https://nextgen-monitor.herokuapp.com", "monitor");
		        health("/gateway/ping?host=https://nextgen-gateway.herokuapp.com", "gateway");
		        alert("Heroku Services Initialized !")
			}
		});
		
		/* $("#healthCheck").click(function() {
			health("/config/ping?host="+$("#epconfig").val(), "config");
	        health("/eureka/ping?host="+$("#epeureka").val(), "eureka");
	        health("/profile/ping?host="+$("#epprofile").val(), "profile");
	        health("/reservation/ping?host="+$("#epreservation").val(), "reservation");
	        health("/addonsvc/ping?host="+$("#epaddone").val(), "addon");
	        health("/monitor/ping?host="+$("#epmonitor").val(), "monitor");
	        health("/gateway/ping?host="+$("#epgateway").val(), "gateway");
		}); */
		
		var health = function (url, id) {
        	$("#"+id).text("Verifying...");
        	$("#"+id).css('color', 'black');
        	$.ajax({
    			url: url,
    			method: 'GET',
    			async: true, 
    			cache: false,
    			success: function () {
    				$("#"+id).text("READY");
    				$("#"+id).css('color', 'green');
    			},
    			error: function (xhr, status, error) {
    				$("#"+id).text("DOWN");
    				$("#"+id).css('color', 'red');
    				window.console.error(xhr.responseText);
    			}
            });
		}
	});

</script>

</body>
</html>
